#!/usr/bin/perl
# $Id: extract_pathways.in,v 1.1 2000-02-29 01:28:18 wilson Exp $

$target = $ARGV[0];

$mode = ($ARGV[1] eq "chains"?0:1);

while (<STDIN>) {

    /\t+/g;
    $rank = pos();
    if ($rank < $lastRank) {
	$lastRank = $rank;
    }
    $line[$rank] = $_;
    
    /([a-z][a-z]?-[0-9]{1,3}[mn]?)/;
    if ($1 eq $target && substr($line[$rank],-3,2) ne "< ") {
	for ($prRank=$lastRank*$mode;$prRank<=$rank;$prRank++) {
	    print $line[$prRank];
	}
	$lastRank = $rank+1;
    }
}
